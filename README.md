# YOLO-Object-Count

# Задание к хакатону НИЯУ МИФИ 
### Детектирование и подсчет объектов на видеозаписи с использованием ultralytics YOLO 11

В проекте используется предобученная модель  YOLO 11

Источник: (https://docs.ultralytics.com/ru/models/yolo11/)
На момент выполнение работы, модель обучена различать 79 классов объектов.

#### Подсчета количества посетителей в парковой зоне

Модель позволяет осуществить подсчет конкретных объектов не только изображении вцелом, но и на отдельном его участвке (регионе). 
В результате будет получено количество объектов каждого класса, прошедшего через зарнее обозначенный участок. 
Регион, в границах которого осуществляется подсчет интересующих объектов задается набором точек и может иметь любоую форму.
Сведения о количестве объекта каждого класса могуть быть сохранены в отдельный файл для послдующего анализа

Пример: 
{'car': {'IN': 44, 'OUT': 93}, 'bus': {'IN': 1, 'OUT': 3}, 'truck': {'IN': 1, 'OUT': 2}, 'person': {'IN': 0, 'OUT': 0}}

### Практическое применение: 

Данные о количестве посетителей в парковой зоне могут указывать администарции на время суток, в которе достигается пиковое значение посетителей с указанием конкретных участков. На основании данных могут быть приняты решения о местах размещения наружной рекламы, дополнительных объектов инфраструктуры (например туалтеов или урн для муссора). Кроме того, указанные данные могут быть предоставлены малому бизнесу для возможной установки точек малой розниченой торговли. 

### Подсчет количества транспортных средств, с целью прогназирования износа дорожного полотна или инеженерного сооружения.

Дальнейшим  развитием идеии учета количества одельной категории транспортных средств на участке дорожного полотна является его сопосталвением с массой каждого транспортного средства с целью получения данных о нагрузке на участок дорожного покрытия или инженерного сооружения (напрмер моста), за изучаемый интервал. Обычное наружное наблюение, используемое в демонстрации, представлятся не достаточным, так как вес каждого транспортного средства может не может быть точно определен, а может быть получен из неких зарнее устанволенных табличных значений. Решением данной проблемы является использование камер считывающих номер транспортного средства, посредством которого из единой базы данным МВД РФ могут быть получены сведения о массе транспортного средства, заявленного в техенической документации при его регистрации. Кроме того, представляетяс возможным учитывать не только массу автомобиля, но и его скорость на конкретном участке, чтобы можно было расчитать степень физического воздействия на дорожное полотно.

Код, демонстрирующий работу библиотеки представлен в блокноте
https://github.com/Krivokulskiy/YOLO-Object-Count/blob/main/YOLO%20hackotone.ipynb

Для оубчения модели необхожимо в словаре train_config указать нужные параметры для обучения, а именно:
* путь для валидационного и обучаещего датасета - train_data_path, valid_data_path соответсвенно.<br>
* is_custom_model - является ли модель для обучения собственной архитектурой (True/False)
* img_size - размер фотографии
* num_epochs - количество эпох
* batch_size - размер батчаей
* lr - learning_rate для градиентного спуска

В методе train_model класса Model_train можно указать нужную функцию потерь и тип градиентного спуска, заменив значения переменных <br>
criterion = nn.CrossEntropyLoss()<br>
optimizer = optim.Adam(self.model.parameters(), lr=self.train_config['lr'])<br>
на нужные<br>

в train_albumentations_transforms можно заменит параметры аугментации на нужные.
Для запуск тестирования модели необходимо в словаре test_config указать нужные параметры. Описание параметров совпадает с параметрами для train_config.

Более подробные описания методов представленна в коде в комментариях.















